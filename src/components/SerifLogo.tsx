// components/SerifLogo.tsx
import React, { useState, useEffect } from 'react';

interface SerifLogoProps {
  size?: number;
  className?: string;
}

const SerifLogo = ({ size = 80, className = '' }: SerifLogoProps) => {
  const [resolvedTheme, setResolvedTheme] = useState<string | null>(null);

  useEffect(() => {
    // Function to read theme from local storage
    const readThemeFromLocalStorage = () => {
      if (typeof window !== 'undefined') {
        setResolvedTheme(localStorage.getItem('theme') || 'light');
      }
    };

    // Initial read when component mounts
    readThemeFromLocalStorage();

    // --- NEW: Listen for the custom themeChange event ---
    if (typeof window !== 'undefined') {
      const handleThemeChange = (event: Event) => {
        const customEvent = event as CustomEvent; // Type assertion
        setResolvedTheme(customEvent.detail.newTheme); // Update state with the new theme from the event
      };

      window.addEventListener('themeChange', handleThemeChange);

      // Cleanup: Remove the event listener when the component unmounts
      return () => {
        window.removeEventListener('themeChange', handleThemeChange);
      };
    }
    // --- END NEW ---

  }, []); // Empty dependency array, as the event listener is set up once

  // Define the SVG for the dark mode logo
  const darkModeLogo = (
    // ... (Your dark mode SVG content here - unchanged)
    <svg
      version="1.0"
      width={`${size}px`}
      height={`${size}px`}
      viewBox="0 0 500 500"
      preserveAspectRatio="xMidYMid meet"
      className={className}
      xmlns="http://www.w3.org/2000/svg"
      xmlnsXlink="http://www.w3.org/1999/xlink"
    >
      <defs />
      <g
        transform="translate(0.000000,500.000000) scale(0.100000,-0.100000)"
        fill="#63a5e9ff" // dark mode logo color (lightened)
        stroke="none"
      >
        <path
          d="m 2580,4924 c -409,-53 -811,-359 -995,-759 -86,-187 -125,-346 -132,-546 -6,-171 5,-268 47,-417 56,-196 208,-466 324,-577 69,-66 187,-165 227,-191 87,-54 225,-125 292,-150 245,-88 550,-101 800,-33 81,21 85,17 186,-206 35,-77 88,-194 118,-260 30,-66 68,-148 84,-183 16,-34 29,-64 29,-66 0,-3 22,-51 49,-108 27,-57 70,-150 96,-208 279,-617 516,-1120 539,-1143 35,-35 70,-22 350,130 149,80 279,153 288,161 33,28 23,79 -35,172 -30,47 -102,164 -162,260 -59,96 -136,220 -170,275 -34,55 -98,159 -142,230 -150,243 -316,510 -419,675 -230,370 -304,496 -304,519 0,16 27,52 84,112 175,183 287,400 348,670 20,90 23,131 23,299 0,178 -3,205 -28,307 -47,191 -109,328 -227,493 -109,152 -193,234 -354,343 -162,109 -292,159 -510,197 -134,23 -250,24 -406,4 z m 391,-120 c 291,-40 554,-196 760,-452 354,-440 362,-1103 20,-1551 -239,-312 -583,-487 -956,-485 -463,1 -882,262 -1094,681 -42,83 -66,148 -103,283 -21,76 -23,106 -23,285 0,175 3,212 24,292 30,124 72,229 133,338 64,114 123,188 234,295 189,182 377,276 629,314 166,26 192,26 376,0 z m 636,-2479 c 29,-50 52,-96 51,-104 -2,-7 -50,-38 -108,-67 l -105,-54 -18,22 c -9,13 -34,58 -54,101 -27,56 -34,83 -27,94 12,19 175,104 194,100 8,-1 38,-43 67,-92 z m 256,-415 c 206,-338 367,-600 457,-745 48,-77 151,-243 230,-370 79,-126 160,-257 181,-291 22,-33 39,-67 39,-76 0,-18 -422,-251 -447,-246 -18,3 -21,8 -64,103 -17,39 -47,104 -66,145 -19,41 -43,93 -53,115 -10,22 -35,76 -56,120 -20,44 -47,103 -59,130 -12,28 -43,93 -68,145 -24,52 -91,196 -147,320 -56,124 -117,258 -136,298 -19,40 -34,75 -34,77 0,4 -23,54 -121,263 -21,45 -36,88 -33,95 7,20 206,117 234,114 21,-2 44,-33 143,-197 z"
        />
        <path
          d="m 1784,3265 c -13,-51 31,-142 138,-287 170,-229 386,-384 653,-467 144,-45 175,-41 175,26 0,30 -3,33 -42,43 -91,23 -236,74 -292,102 -212,106 -408,305 -514,522 -39,79 -45,86 -84,86 -21,0 -29,-6 -34,-25 z"
        />
        <path
          d="M 567,4875 C 219,4787 -2,4401 90,4038 c 41,-166 132,-291 334,-465 338,-291 481,-468 637,-788 98,-203 178,-486 240,-850 29,-168 33,-218 37,-431 0.7279,-50.4061 0.7273,-97.832 -0.1284,-143.4286 C 1334.0251,1155.5982 1312.8997,987.59219 1263,752 1231,600 1146,479 1009,390 920,332 852,314 775,327 693,341 609,382 557,435 506,486 448,593 429,670 c -17,70 -17,190 0,258 18,72 79,160 140,201 43,29 62,35 124,39 120,7 202,-40 256,-150 35,-69 39,-118 16,-195 -21,-71 -70,-113 -131,-113 -37,0 -51,5 -76,31 -29,28 -30,33 -24,83 7,65 -6,84 -47,65 -38,-17 -60,-79 -47,-129 31,-117 173,-179 284,-125 47,22 112,103 126,155 31,115 17,203 -50,311 -30,50 -31,53 -14,66 12,9 55,13 140,13 117,0 123,1 130,22 5,16 0,27 -16,40 -22,18 -43,19 -324,16 l -301,-3 -63,-34 C 313,1091 250,755 412,472 505,309 655,228 865,226 c 155,0 317,42 625,167 815,328 1178,419 1855,465 l 240,17 3,32 c 5,51 -12,55 -215,43 -184,-10 -367,-25 -431,-35 -187,-29 -420,-78 -602,-126 -169,-45 -497,-152 -575,-188 -22,-10 -67,-28 -100,-41 -33,-13 -118,-48 -190,-78 -163,-68 -284,-112 -307,-112 -24,0 -23,13 3,36 35,31 104,125 132,179 33,64 62,190 87,380 12,83 25,184 31,225 18,124 5,476 -25,680 -102,687 -260,1088 -571,1443 -42,48 -140,145 -218,215 -336,301 -397,381 -442,584 -10,46 -10,75 1,155 14,112 30,162 79,248 88,156 292,276 475,278 64,1 84,-3 135,-28 106,-52 172,-138 206,-268 31,-120 21,-206 -37,-304 -30,-52 -111,-119 -162,-133 -52,-14 -127,-13 -165,3 -51,22 -104,88 -112,140 -16,103 44,172 150,172 45,0 50,2 53,23 6,41 -24,62 -88,62 -73,0 -136,-38 -177,-107 -24,-41 -28,-58 -28,-123 0,-85 20,-133 77,-186 63,-60 113,-78 213,-79 82,0 96,3 157,33 143,70 218,209 218,402 0,122 -15,177 -80,295 -35,64 -38,74 -25,85 12,10 106,12 433,9 l 417,-4 3,33 c 2,20 -2,34 -10,36 -7,3 -213,10 -458,15 -245,6 -528,13 -630,16 -142,3 -199,1 -243,-10 z"
        />
      </g>
    </svg>
  );

  // Define the SVG for the light mode logo
  const lightModeLogo = (
    // ... (Your light mode SVG content here - unchanged)
    <svg
      version="1.0"
      width={`${size}px`}
      height={`${size}px`}
      viewBox="0 0 500 500"
      preserveAspectRatio="xMidYMid meet"
      className={className}
      xmlns="http://www.w3.org/2000/svg"
      xmlnsXlink="http://www.w3.org/1999/xlink"
    >
      <defs />
      <g
        transform="translate(0.000000,500.000000) scale(0.100000,-0.100000)"
        fill="#2c3db3" // Light mode logo color
        stroke="none"
      >
        <path
          d="m 2580,4924 c -409,-53 -811,-359 -995,-759 -86,-187 -125,-346 -132,-546 -6,-171 5,-268 47,-417 56,-196 208,-466 324,-577 69,-66 187,-165 227,-191 87,-54 225,-125 292,-150 245,-88 550,-101 800,-33 81,21 85,17 186,-206 35,-77 88,-194 118,-260 30,-66 68,-148 84,-183 16,-34 29,-64 29,-66 0,-3 22,-51 49,-108 27,-57 70,-150 96,-208 279,-617 516,-1120 539,-1143 35,-35 70,-22 350,130 149,80 279,153 288,161 33,28 23,79 -35,172 -30,47 -102,164 -162,260 -59,96 -136,220 -170,275 -34,55 -98,159 -142,230 -150,243 -316,510 -419,675 -230,370 -304,496 -304,519 0,16 27,52 84,112 175,183 287,400 348,670 20,90 23,131 23,299 0,178 -3,205 -28,307 -47,191 -109,328 -227,493 -109,152 -193,234 -354,343 -162,109 -292,159 -510,197 -134,23 -250,24 -406,4 z m 391,-120 c 291,-40 554,-196 760,-452 354,-440 362,-1103 20,-1551 -239,-312 -583,-487 -956,-485 -463,1 -882,262 -1094,681 -42,83 -66,148 -103,283 -21,76 -23,106 -23,285 0,175 3,212 24,292 30,124 72,229 133,338 64,114 123,188 234,295 189,182 377,276 629,314 166,26 192,26 376,0 z m 636,-2479 c 29,-50 52,-96 51,-104 -2,-7 -50,-38 -108,-67 l -105,-54 -18,22 c -9,13 -34,58 -54,101 -27,56 -34,83 -27,94 12,19 175,104 194,100 8,-1 38,-43 67,-92 z m 256,-415 c 206,-338 367,-600 457,-745 48,-77 151,-243 230,-370 79,-126 160,-257 181,-291 22,-33 39,-67 39,-76 0,-18 -422,-251 -447,-246 -18,3 -21,8 -64,103 -17,39 -47,104 -66,145 -19,41 -43,93 -53,115 -10,22 -35,76 -56,120 -20,44 -47,103 -59,130 -12,28 -43,93 -68,145 -24,52 -91,196 -147,320 -56,124 -117,258 -136,298 -19,40 -34,75 -34,77 0,4 -23,54 -121,263 -21,45 -36,88 -33,95 7,20 206,117 234,114 21,-2 44,-33 143,-197 z"
        />
        <path
          d="m 1784,3265 c -13,-51 31,-142 138,-287 170,-229 386,-384 653,-467 144,-45 175,-41 175,26 0,30 -3,33 -42,43 -91,23 -236,74 -292,102 -212,106 -408,305 -514,522 -39,79 -45,86 -84,86 -21,0 -29,-6 -34,-25 z"
        />
        <path
          d="M 567,4875 C 219,4787 -2,4401 90,4038 c 41,-166 132,-291 334,-465 338,-291 481,-468 637,-788 98,-203 178,-486 240,-850 29,-168 33,-218 37,-431 0.7279,-50.4061 0.7273,-97.832 -0.1284,-143.4286 C 1334.0251,1155.5982 1312.8997,987.59219 1263,752 1231,600 1146,479 1009,390 920,332 852,314 775,327 693,341 609,382 557,435 506,486 448,593 429,670 c -17,70 -17,190 0,258 18,72 79,160 140,201 43,29 62,35 124,39 120,7 202,-40 256,-150 35,-69 39,-118 16,-195 -21,-71 -70,-113 -131,-113 -37,0 -51,5 -76,31 -29,28 -30,33 -24,83 7,65 -6,84 -47,65 -38,-17 -60,-79 -47,-129 31,-117 173,-179 284,-125 47,22 112,103 126,155 31,115 17,203 -50,311 -30,50 -31,53 -14,66 12,9 55,13 140,13 117,0 123,1 130,22 5,16 0,27 -16,40 -22,18 -43,19 -324,16 l -301,-3 -63,-34 C 313,1091 250,755 412,472 505,309 655,228 865,226 c 155,0 317,42 625,167 815,328 1178,419 1855,465 l 240,17 3,32 c 5,51 -12,55 -215,43 -184,-10 -367,-25 -431,-35 -187,-29 -420,-78 -602,-126 -169,-45 -497,-152 -575,-188 -22,-10 -67,-28 -100,-41 -33,-13 -118,-48 -190,-78 -163,-68 -284,-112 -307,-112 -24,0 -23,13 3,36 35,31 104,125 132,179 33,64 62,190 87,380 12,83 25,184 31,225 18,124 5,476 -25,680 -102,687 -260,1088 -571,1443 -42,48 -140,145 -218,215 -336,301 -397,381 -442,584 -10,46 -10,75 1,155 14,112 30,162 79,248 88,156 292,276 475,278 64,1 84,-3 135,-28 106,-52 172,-138 206,-268 31,-120 21,-206 -37,-304 -30,-52 -111,-119 -162,-133 -52,-14 -127,-13 -165,3 -51,22 -104,88 -112,140 -16,103 44,172 150,172 45,0 50,2 53,23 6,41 -24,62 -88,62 -73,0 -136,-38 -177,-107 -24,-41 -28,-58 -28,-123 0,-85 20,-133 77,-186 63,-60 113,-78 213,-79 82,0 96,3 157,33 143,70 218,209 218,402 0,122 -15,177 -80,295 -35,64 -38,74 -25,85 12,10 106,12 433,9 l 417,-4 3,33 c 2,20 -2,34 -10,36 -7,3 -213,10 -458,15 -245,6 -528,13 -630,16 -142,3 -199,1 -243,-10 z"
        />
      </g>
    </svg>
  );

  if (resolvedTheme === null) {
    return null; // Or a temporary fallback like lightModeLogo
  }

  return resolvedTheme === 'dark' ? darkModeLogo : lightModeLogo;
};

export default SerifLogo;